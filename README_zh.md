# POPå£è¢‹çœ¼ç§‘åŒ»ç”Ÿå›¾åƒæ£€æµ‹æ¥å£è°ƒç”¨å·¥å…·

[![Python 3.7+](https://img.shields.io/badge/python-3.7+-blue.svg)](https://www.python.org/downloads/)
[![GitHub](https://img.shields.io/badge/GitHub-Repository-blue)](https://github.com)
<img width="1795" height="406" alt="ä¸­å±±çœ¼ç§‘ä¸­å¿ƒ" src="https://github.com/user-attachments/assets/d372bf50-57d5-4794-8445-68fce824fcc4" />


**Homepage** | **GitHub** | **Documentation**

---

## ğŸ‘ï¸ Table of Contents

1. [Introduction](#1-introduction)
2. [Features](#2-features)
3. [Installation](#3-installation)
4. [Quick Start](#4-quick-start)
5. [Project Structure](#5-project-structure)
6. [Error Handling](#6-error-handling)
7. [Configuration](#7-configuration)
8. [Contact](#8-contact)

---

## 1. Introduction

### 1.1 å…³äºPOPå£è¢‹çœ¼ç§‘åŒ»ç”Ÿ

**POPå£è¢‹çœ¼ç§‘åŒ»ç”Ÿ**æ˜¯åŸºäºäººå·¥æ™ºèƒ½æŠ€æœ¯è®­ç»ƒå…·æœ‰ä¸€å®šå…ˆéªŒçŸ¥è¯†çš„è£‚éš™ç¯çœ¼å‰èŠ‚ç—…ç¶æ£€æµ‹æ¨¡å‹ï¼Œå®ç°å¯¹çœ¼å‰èŠ‚è£‚éš™ç¯å›¾åƒä¸­çš„å¸¸è§ç—…è¿›è¡Œç—…ç¶è¯†åˆ«ï¼ŒåŒ…å«ç™½å†…éšœã€è§’è†œç—…å˜ã€ç¿¼çŠ¶èƒ¬è‚‰ã€ç»“è†œä¸‹å‡ºè¡€ç­‰16ç§å¸¸è§çœ¼ç—…ã€‚

- ğŸŒ **å®˜ç½‘é“¾æ¥**ï¼šhttps://pop.gzzoc.org.cn/
- ğŸ¥ **è§†é¢‘å±•ç¤º**ï¼š


https://github.com/user-attachments/assets/c6228443-aec1-430b-b3ab-491142edbf2a


### 1.2 å…³äºæœ¬é¡¹ç›®

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªä½¿ç”¨Pythonè°ƒç”¨POPå£è¢‹çœ¼ç§‘åŒ»ç”Ÿæ£€æµ‹æ¥å£çš„è½»é‡çº§å·¥å…·åº“ã€‚é€šè¿‡ç®€å•çš„APIè°ƒç”¨ï¼Œä½ å¯ä»¥ä¸Šä¼ å›¾ç‰‡å¹¶è·å–è¯¦ç»†çš„æ£€æµ‹ç»“æœï¼ŒåŒ…æ‹¬ç›®æ ‡æ ‡ç­¾ã€ç½®ä¿¡åº¦åˆ†æ•°å’Œè¾¹ç•Œæ¡†åæ ‡ç­‰ä¿¡æ¯ã€‚

æœ¬é¡¹ç›®ç‰¹åˆ«é€‚ç”¨äºï¼š

- ğŸ¥ **åŒ»ç–—å›¾åƒåˆ†æ**ï¼šæ£€æµ‹çœ¼éƒ¨ç–¾ç—…ï¼ˆç™½å†…éšœã€ç¿¼çŠ¶èƒ¬è‚‰ç­‰ï¼‰
- ğŸ¯ **ç›®æ ‡è¯†åˆ«**ï¼šè¯†åˆ«å›¾ç‰‡ä¸­çš„ç‰¹å®šç›®æ ‡

---

## 2. Features

| ç‰¹æ€§                   | æè¿°                                       |
| ---------------------- | ------------------------------------------ |
| ğŸ“¸**å›¾ç‰‡ä¸Šä¼ **   | æ”¯æŒä¸Šä¼ å›¾ç‰‡æ–‡ä»¶è¿›è¡Œæ£€æµ‹                   |
| ğŸ”**è¯¦ç»†ç»“æœ**   | è¿”å›è¾¹ç•Œæ¡†ã€æ ‡ç­¾ã€ç½®ä¿¡åº¦ç­‰å®Œæ•´ä¿¡æ¯         |
| ğŸ–¼ï¸**å›¾ç‰‡æ ‡æ³¨** | è‡ªåŠ¨åœ¨å›¾ç‰‡ä¸Šæ ‡æ³¨æ£€æµ‹ç›®æ ‡ï¼ŒåŒ…æ‹¬è¾¹ç•Œæ¡†å’Œæ ‡ç­¾ |
| ğŸ›¡ï¸**é”™è¯¯å¤„ç†** | å®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œé”™è¯¯æç¤º                   |
| ğŸ”„**äº¤äº’å¼ä½¿ç”¨** | æ”¯æŒå¾ªç¯è¾“å…¥å¤šå¼ å›¾ç‰‡è¿›è¡Œæ£€æµ‹               |

## 3. Installation

### 3.1 ç³»ç»Ÿè¦æ±‚

- Python 3.7 æˆ–æ›´é«˜ç‰ˆæœ¬
- pip åŒ…ç®¡ç†å™¨

### 3.2 å®‰è£…æ­¥éª¤

**æ­¥éª¤1ï¼šå…‹éš†é¡¹ç›®**

```bash
git clone https://github.com/huapu4/POP.git
cd POP
```

**æ­¥éª¤2ï¼šå®‰è£…ä¾èµ–**

```bash
pip install -r requirements.txt
```

> ğŸ’¡ **Note**: å¦‚æœä½¿ç”¨Python 3ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ `pip3` å‘½ä»¤ã€‚å»ºè®®ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒæ¥ç®¡ç†ä¾èµ–ã€‚

---

## 4. Quick Start

### 4.1 äº¤äº’å¼ä½¿ç”¨

è¿è¡Œç¨‹åºåï¼ŒæŒ‰æç¤ºè¾“å…¥å›¾ç‰‡è·¯å¾„å³å¯ï¼š

```bash
python run.py
```

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```
============================================================
Pocket Ophthalmologist (POP) Tool
============================================================

Please enter image path to detect (enter 'q' or 'quit' to exit): test.jpg

Detecting image: test.jpg
------------------------------------------------------------

==================================================
Detection Results
==================================================

Detected 3 target(s):

Target 1:
  Label: Eye
  Confidence: 0.9468135
  Position: left=12, top=11, right=1277, bottom=729

Target 2:
  Label: Cataract
  Confidence: 0.82525355
  Position: left=719, top=296, right=829, bottom=413

Target 3:
  Label: Pterygium
  Confidence: 0.79924196
  Position: left=167, top=284, right=642, bottom=639

==================================================

âœ“ Annotated image saved to: output/test_annotated_20240114_123456.jpg

Please enter image path to detect (enter 'q' or 'quit' to exit): q

Thank you for using, goodbye!
```
![test_annotated](https://github.com/user-attachments/assets/32931c67-37ab-46c3-b3f7-7d5a0e6770f8)

### 4.2 åŠŸèƒ½è¯´æ˜

- âœ… **äº¤äº’å¼æ£€æµ‹**ï¼šè¿è¡Œç¨‹åºåï¼Œå¯ä»¥å¾ªç¯è¾“å…¥å¤šå¼ å›¾ç‰‡è·¯å¾„è¿›è¡Œæ£€æµ‹
- âœ… **æ ¼å¼åŒ–è¾“å‡º**ï¼šæ£€æµ‹ç»“æœä»¥è‹±æ–‡æ ¼å¼æ¸…æ™°æ˜¾ç¤ºåœ¨æ§åˆ¶å°
- âœ… **å›¾ç‰‡æ ‡æ³¨**ï¼šè‡ªåŠ¨åœ¨å›¾ç‰‡ä¸Šæ ‡æ³¨æ£€æµ‹åˆ°çš„ç›®æ ‡ï¼ŒåŒ…æ‹¬è¾¹ç•Œæ¡†å’Œæ ‡ç­¾ï¼Œä¿å­˜åˆ° `output/` æ–‡ä»¶å¤¹
- âœ… **æ ‡ç­¾ç¿»è¯‘**ï¼šæ§åˆ¶å°è¾“å‡ºè‡ªåŠ¨å°†ä¸­æ–‡æ ‡ç­¾ç¿»è¯‘ä¸ºè‹±æ–‡
- âœ… **é”™è¯¯å¤„ç†**ï¼šè‡ªåŠ¨æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€æ ¼å¼æ˜¯å¦æ”¯æŒ

---

## 5. Project Structure

```
.
â”œâ”€â”€ run.py                    # ç¨‹åºå…¥å£æ–‡ä»¶ï¼ˆè¿è¡Œæ­¤æ–‡ä»¶å¯åŠ¨ç¨‹åºï¼‰
â”œâ”€â”€ src/                      # æºä»£ç ç›®å½•
â”‚   â””â”€â”€ main.py              # ä¸»ç¨‹åºæ–‡ä»¶
â”œâ”€â”€ config/                   # é…ç½®ç›®å½•
â”‚   â””â”€â”€ config.py            # APIé…ç½®æ–‡ä»¶
â”œâ”€â”€ utils/                    # å·¥å…·æ¨¡å—ç›®å½•
â”‚   â”œâ”€â”€ api_client.py        # APIå®¢æˆ·ç«¯æ¨¡å—
â”‚   â”œâ”€â”€ label_mapping.py     # ä¸­è‹±æ–‡æ ‡ç­¾æ˜ å°„
â”‚   â”œâ”€â”€ image_annotator.py   # å›¾ç‰‡æ ‡æ³¨æ¨¡å—
â”‚   â”œâ”€â”€ font_manager.py      # å­—ä½“ç®¡ç†æ¨¡å—
â”‚   â””â”€â”€ fonts/               # å­—ä½“æ–‡ä»¶ç›®å½•
â”‚       â””â”€â”€ simhei.ttf       # é»‘ä½“å­—ä½“æ–‡ä»¶
â”œâ”€â”€ output/                   # è¾“å‡ºç›®å½•ï¼ˆæ ‡æ³¨åçš„å›¾ç‰‡ä¿å­˜åœ¨æ­¤ï¼‰
â”œâ”€â”€ requirements.txt          # ä¾èµ–åŒ…åˆ—è¡¨
â””â”€â”€ README.md                # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

### æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶/ç›®å½•                    | æè¿°                                       |
| ---------------------------- | ------------------------------------------ |
| `run.py`                   | ç¨‹åºå…¥å£æ–‡ä»¶ï¼Œè¿è¡Œæ­¤æ–‡ä»¶å¯åŠ¨ç¨‹åº           |
| `src/main.py`              | æ ¸å¿ƒä»£ç æ–‡ä»¶ï¼ŒåŒ…å«ä¸»å‡½æ•°å’Œå›¾ç‰‡å¤„ç†é€»è¾‘     |
| `config/config.py`         | APIé…ç½®æ–‡ä»¶                                |
| `utils/api_client.py`      | APIå®¢æˆ·ç«¯æ¨¡å—ï¼Œç”¨äºå‘é€æ£€æµ‹è¯·æ±‚            |
| `utils/label_mapping.py`   | ä¸­è‹±æ–‡æ ‡ç­¾æ˜ å°„å­—å…¸                         |
| `utils/image_annotator.py` | å›¾ç‰‡æ ‡æ³¨æ¨¡å—ï¼Œç”¨äºåœ¨å›¾ç‰‡ä¸Šç»˜åˆ¶è¾¹ç•Œæ¡†å’Œæ ‡ç­¾ |
| `utils/font_manager.py`    | å­—ä½“ç®¡ç†æ¨¡å—ï¼Œç”¨äºåŠ è½½ä¸­æ–‡å­—ä½“             |
| `utils/fonts/simhei.ttf`   | é»‘ä½“å­—ä½“æ–‡ä»¶ï¼Œç”¨äºåœ¨å›¾ç‰‡ä¸Šæ¸²æŸ“ä¸­æ–‡æ–‡å­—     |
| `output/`                  | è¾“å‡ºç›®å½•ï¼Œæ ‡æ³¨åçš„å›¾ç‰‡ä¿å­˜åœ¨æ­¤             |
| `requirements.txt`         | Pythonä¾èµ–åŒ…åˆ—è¡¨                           |
| `README.md`                | é¡¹ç›®è¯´æ˜æ–‡æ¡£                               |

---

## 6. Error Handling

ç¨‹åºåŒ…å«å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼š

| é”™è¯¯ç±»å‹     | å¤„ç†æ–¹å¼                                      |
| ------------ | --------------------------------------------- |
| æ–‡ä»¶ä¸å­˜åœ¨   | æŠ›å‡º `FileNotFoundError` å¼‚å¸¸ï¼Œæç¤ºæ–‡ä»¶è·¯å¾„ |
| ç½‘ç»œè¯·æ±‚å¼‚å¸¸ | æ•è·å¹¶æ‰“å°è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼Œè¿”å› `None`         |
| JSONè§£æé”™è¯¯ | æ•è·å¹¶æ‰“å°å“åº”å†…å®¹ï¼Œä¾¿äºè°ƒè¯•                  |
| å…¶ä»–å¼‚å¸¸     | ç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼Œç¡®ä¿ç¨‹åºç¨³å®šè¿è¡Œ                |

### é”™è¯¯ç¤ºä¾‹

**æ–‡ä»¶ä¸å­˜åœ¨ï¼š**

```
FileNotFoundError: å›¾ç‰‡æ–‡ä»¶ä¸å­˜åœ¨: wrong_path.jpg
```

**ç½‘ç»œé”™è¯¯ï¼š**

```
è¯·æ±‚å¤±è´¥: Connection timeout
é”™è¯¯è¯¦æƒ…: [é”™è¯¯è¯¦æƒ…ä¿¡æ¯]
```

**APIé”™è¯¯ï¼š**

```
è¯·æ±‚å¤±è´¥: 400 Bad Request
é”™è¯¯è¯¦æƒ…: [APIè¿”å›çš„é”™è¯¯ä¿¡æ¯]
```

---

## 7. Configuration

### 7.1 ä¾èµ–åŒ…

| åŒ…å         | ç‰ˆæœ¬     | ç”¨é€”               |
| ------------ | -------- | ------------------ |
| `requests` | >=2.31.0 | ç”¨äºå‘é€HTTPè¯·æ±‚   |
| `Pillow`   | >=10.0.0 | ç”¨äºå›¾ç‰‡å¤„ç†å’Œæ ‡æ³¨ |

### 7.2 æ³¨æ„äº‹é¡¹

> âš ï¸ **Important Notes**:
>
> 1. ç¡®ä¿å›¾ç‰‡æ–‡ä»¶è·¯å¾„æœ‰æ•ˆ
> 3. ç½‘ç»œè¿æ¥æ­£å¸¸

---

## 8. Contact

å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- ğŸ› **Issues**: [GitHub Issues](https://github.com/huapu4/POP/issues)
- ğŸ’¬ **è®¨è®º**: æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

---

## Acknowledgments

æ„Ÿè°¢æ‰€æœ‰ä¸ºæœ¬é¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…ï¼

---

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ªStaræ”¯æŒä¸€ä¸‹ï¼**

